<!-- Include SweetAlert2 CSS & JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>

<script>
    $(document).ready(function () {
        // Inisialisasi DataTable
        var table = $('#SoalTable').DataTable();
        var currentRow; // Menyimpan baris yang sedang diedit

        // Tambah Soal Pilihan Ganda
        $('#formTambahSoal').on('submit', function (e) {
            e.preventDefault();

            // Ambil nilai dari inputan
            var soal = $('#soal').val();
            var pilA = $('#pilA').val();
            var pilB = $('#pilB').val();
            var pilC = $('#pilC').val();
            var pilD = $('#pilD').val();
            var pilE = $('#pilE').val();
            var kunci = $('#kunci').val();

            // Cek jika ada baris yang sedang diedit
            if (currentRow) {
                // Update DataTable jika sedang mengedit
                table.row(currentRow).data([
                    table.rows().count(), // No (otomatis dihitung)
                    soal, // Soal
                    pilA, // Pilihan A
                    pilB, // Pilihan B
                    pilC, // Pilihan C
                    pilD, // Pilihan D
                    pilE, // Pilihan E
                    kunci, // Kunci Jawaban
                    `<button class="btn btn-sm btn-primary editBtn"><i class="fa fa-edit"></i></button>
                     <button class="btn btn-sm btn-danger deleteBtn"><i class="fa fa-trash"></i></button>`
                ]).draw();

                currentRow = null; // Reset currentRow setelah edit
            } else {
                // Tambahkan data baru ke DataTable
                table.row.add([
                    table.rows().count() + 1, // No
                    soal, // Soal
                    pilA, // Pilihan A
                    pilB, // Pilihan B
                    pilC, // Pilihan C
                    pilD, // Pilihan D
                    pilE, // Pilihan E
                    kunci, // Kunci Jawaban
                    `<button class="btn btn-sm btn-primary editBtn"><i class="fa fa-edit"></i></button>
                     <button class="btn btn-sm btn-danger deleteBtn"><i class="fa fa-trash"></i></button>`
                ]).draw();
            }

            // Tampilkan notifikasi menggunakan SweetAlert2
            Swal.fire({
                icon: 'success',
                title: 'Berhasil!',
                text: 'Soal berhasil ditambahkan.',
                timer: 2000,
                showConfirmButton: false
            });

            // Tutup modal dan reset form
            $('#addSoal').modal('hide');
            $('#formTambahSoal')[0].reset();
        });

        // Hapus Soal
        $('#SoalTable tbody').on('click', '.deleteBtn', function () {
            table.row($(this).parents('tr')).remove().draw();
        });

        // Edit Soal
        $('#SoalTable tbody').on('click', '.editBtn', function () {
            currentRow = $(this).parents('tr'); // Simpan baris yang sedang diedit

            var data = table.row(currentRow).data(); // Ambil data dari baris
            $('#soal').val(data[1]); // Soal
            $('#pilA').val(data[2]); // Pilihan A
            $('#pilB').val(data[3]); // Pilihan B
            $('#pilC').val(data[4]); // Pilihan C
            $('#pilD').val(data[5]); // Pilihan D
            $('#pilE').val(data[6]); // Pilihan E
            $('#kunci').val(data[7]); // Kunci Jawaban

            // Tampilkan modal
            $('#addSoal').modal('show');
        });
    });
</script>
